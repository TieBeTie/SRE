# Отчёт о нагрузочном тестировании


Проведено нагрузочное тестирование API приложения для определения максимальной производительности системы и выявления узких мест. Нагрузка подавалась через HTTP запросы к ingress, что соответствует реальному сценарию использования.

## 1. Профиль нагрузки

**Эндпоинты:**
- `GET /Cities/{id}` — 80% запросов
- `GET /Cities` — 20% запросов

**Параметры:**
- Think time: 0.2-0.7 секунд
- Постепенное увеличение нагрузки (ramp-up)

**Скрипты:** `scripts/smoke_test.js`, `scripts/load_test.js`, `scripts/gradual_load_test.js`

## 2. SLO/SLA

| Метрика | SLO | Фактическое |
|---------|-----|-------------|
| Availability | 99.9% | 100% ✅ |
| Latency p95 | < 500ms | 75ms ✅ |
| Error Rate | < 0.1% | 0% ✅ |
| Throughput | ≥ 100 RPS | 194 RPS ✅ |

## 3. Максимальная производительность

Проведен тест с нагрузкой 200 виртуальных пользователей в течение 3 минут. Обработано 34,004 запросов, пропускная способность ~194 RPS. Error rate 0%, p95 latency 71ms, успешность 99.78%. Все SLO/SLA выполнены.

## 4. Узкое место

Узким местом системы являются соединения к базе данных PostgreSQL. Во время теста при постепенном повышении нагрузки был зафиксирован пик в 194 активных соединения к БД (см. `reposrts/screenshots/postgres_active_connections.png`). Максимальная производительность ~194 RPS достигается при максимальной нагрузке на пул соединений.

Использование CPU на всех нодах составило всего 6.5% (см. `reposrts/screenshots/cpu_usage.png`), что исключает процессор как узкое место. Проблема в ограничениях на уровне пула соединений, а не в ресурсах инфраструктуры.

Конфигурация: 3 реплики API по 0.3 CPU каждая.

## 5. Выводы

Система стабильно работает при нагрузке до 200 VUs (~194 RPS), все SLO/SLA выполнены. Узкое место — соединения к PostgreSQL (194 соединения при пике). CPU не является ограничением (6.5% использования). Для масштабирования требуется оптимизация connection pool и увеличение лимитов соединений к БД.
